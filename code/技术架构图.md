# RecruitAI æ™ºèƒ½æ‹›è˜åŠ©æ‰‹ç³»ç»Ÿ - æŠ€æœ¯æ¶æ„æ¡†æ¶

é’ˆå¯¹ `project` æ–‡ä»¶å¤¹ä¸­çš„é¡¹ç›®ï¼Œè¯¥ç³»ç»Ÿï¼ˆRecruitAIï¼‰é‡‡ç”¨äº†ç°ä»£åŒ–çš„ **AI-Native åº”ç”¨æ¶æ„**ã€‚ä»¥ä¸‹æ˜¯ç³»ç»Ÿçš„æŠ€æœ¯é€‰å‹ã€æ¨¡å—ç»„æˆåŠäº¤äº’é€»è¾‘ã€‚

### **1. ç³»ç»ŸæŠ€æœ¯æ¶æ„å›¾ (Mermaid)**

```mermaid
graph TD
    %% æ ·å¼å®šä¹‰ï¼šæ‰å¹³åŒ–ã€ä¸“ä¸šé…è‰²
    classDef layer_ui fill:#E3F2FD,stroke:#1565C0,stroke-width:2px,rx:5,ry:5;
    classDef layer_gateway fill:#F3E5F5,stroke:#7B1FA2,stroke-width:2px,rx:5,ry:5;
    classDef layer_brain fill:#FFF9C4,stroke:#FBC02D,stroke-width:2px,rx:5,ry:5;
    classDef layer_biz fill:#E8F5E9,stroke:#2E7D32,stroke-width:2px,rx:5,ry:5;
    classDef layer_data fill:#F5F5F5,stroke:#616161,stroke-width:2px,rx:5,ry:5;

    %% 1. ç”¨æˆ·äº¤äº’å±‚ (Presentation Layer)
    subgraph Layer_UI ["ğŸ–¥ï¸ ç”¨æˆ·äº¤äº’å±‚ (Presentation Layer)"]
        direction TB
        UI_Portal["Web å‰ç«¯é—¨æˆ·<br/>(React 19 + Tailwind)"]
        UI_Chat["æ™ºèƒ½å¯¹è¯ç»„ä»¶<br/>(Chat Interface)"]
        UI_Visual["æ•°æ®å¯è§†åŒ–çœ‹æ¿<br/>(Recharts)"]
    end

    %% 2. æ¥å…¥ç½‘å…³å±‚ (Gateway Layer)
    subgraph Layer_Gateway ["ğŸšª æ¥å…¥ç½‘å…³å±‚ (API Gateway)"]
        direction TB
        API_Rest["RESTful API æœåŠ¡<br/>(FastAPI)"]
        API_Socket["WebSocket å®æ—¶æ¨æµ"]
        API_Auth["å®‰å…¨è®¤è¯ä¸é‰´æƒ<br/>(JWT / OAuth2)"]
    end

    %% 3. æ™ºèƒ½ä¸­æ¢å±‚ (Intelligent Core)
    subgraph Layer_Brain ["ğŸ§  æ™ºèƒ½ä¸­æ¢å±‚ (Agent Orchestrator)"]
        direction TB
        Brain_Router["æ„å›¾è¯†åˆ«è·¯ç”±<br/>(Intent Router)"]
        Brain_Planner["ä»»åŠ¡è§„åˆ’ä¸è°ƒåº¦<br/>(Task Planner)"]
        Brain_Memory["å…¨ä¼šè¯è®°å¿†ç®¡ç†<br/>(Context Memory)"]
    end

    %% 4. ä¸šåŠ¡èƒ½åŠ›å±‚ (Business Capability Layer)
    subgraph Layer_Biz ["âš™ï¸ ä¸šåŠ¡èƒ½åŠ›ä¸åä½œå±‚"]
        direction TB
        
        %% 4.1 åŸå­æŠ€èƒ½æ± 
        subgraph Module_Skills ["ğŸ› ï¸ åŸå­æŠ€èƒ½æ±  (Skill Registry)"]
            direction TB
            Skill_Search["ğŸ” æ™ºèƒ½æœç´¢æœåŠ¡<br/>(äººæ‰/èŒä½æ··åˆæ£€ç´¢)"]
            Skill_Analysis["ğŸ§  æ·±åº¦åˆ†ææœåŠ¡<br/>(äººå²—åŒ¹é…/ç®€å†è¯„åˆ†)"]
            Skill_Action["âš¡ ä¸šåŠ¡æ‰§è¡ŒæœåŠ¡<br/>(JDç”Ÿæˆ/é¢è¯•é¢˜ç”Ÿæˆ)"]
            Skill_KB["ğŸ“š çŸ¥è¯†é—®ç­”æœåŠ¡<br/>(RAG å¢å¼ºæ£€ç´¢)"]
        end

        %% 4.2 å¤šæ™ºèƒ½ä½“åä½œå­ç³»ç»Ÿ
        subgraph Module_Agents ["ğŸ‘¥ å¤šæ™ºèƒ½ä½“åä½œå­ç³»ç»Ÿ (Multi-Agent)"]
            direction TB
            Sys_Interview["ğŸ¤ æ™ºèƒ½é¢è¯•å­ç³»ç»Ÿ<br/>(Planner/Questioner/Evaluator)"]
            Sys_Resume["ğŸ“„ ç®€å†è§£æå­ç³»ç»Ÿ<br/>(OCR/Extraction/Scoring)"]
            Sys_Match["ğŸ§© æ™ºèƒ½åŒ¹é…å¼•æ“<br/>(Vector/Semantic Match)"]
        end
    end

    %% 5. æ¨¡å‹ä¸æ•°æ®åŸºåº§ (Infrastructure Layer)
    subgraph Layer_Infra ["ğŸ—ï¸ æ¨¡å‹ä¸æ•°æ®åŸºåº§ (Infrastructure)"]
        direction TB
        
        subgraph Models ["ğŸ¤– æ¨¡å‹æœåŠ¡"]
            Model_LLM["å¤§è¯­è¨€æ¨¡å‹<br/>(DeepSeek-V3)"]
            Model_Embed["å‘é‡åµŒå…¥æ¨¡å‹<br/>(BGE/Ark)"]
            Model_ASR["è¯­éŸ³è¯†åˆ«æ¨¡å‹<br/>(Faster-Whisper)"]
        end

        subgraph Data ["ğŸ’¾ æ•°æ®å­˜å‚¨"]
            DB_Vector["å‘é‡æ•°æ®åº“<br/>(ChromaDB)"]
            DB_SQL["å…³ç³»å‹æ•°æ®åº“<br/>(SQLite)"]
            DB_File["éç»“æ„åŒ–å­˜å‚¨<br/>(File System)"]
        end
    end

    %% æ ¸å¿ƒé“¾è·¯è¿æ¥
    UI_Portal --> API_Rest
    UI_Chat --> API_Rest & API_Socket
    
    API_Rest --> API_Auth
    API_Auth --> Brain_Router

    %% æ™ºèƒ½ä¸­æ¢è°ƒåº¦
    Brain_Router --> Brain_Planner
    Brain_Planner <--> Brain_Memory
    
    %% è°ƒåº¦åˆ°ä¸šåŠ¡å±‚
    Brain_Planner == "å·¥å…·è°ƒç”¨ (Tool Call)" ==> Module_Skills
    Brain_Planner == "ä»»åŠ¡å§”æ´¾ (Delegate)" ==> Module_Agents

    %% ä¸šåŠ¡å±‚è°ƒç”¨åŸºåº§
    Module_Skills --> Models
    Module_Skills --> Data
    
    Module_Agents --> Models
    Module_Agents --> Data

    %% æ ·å¼åº”ç”¨
    class UI_Portal,UI_Chat,UI_Visual layer_ui;
    class API_Rest,API_Socket,API_Auth layer_gateway;
    class Brain_Router,Brain_Planner,Brain_Memory layer_brain;
    class Skill_Search,Skill_Analysis,Skill_Action,Skill_KB,Sys_Interview,Sys_Resume,Sys_Match layer_biz;
    class Model_LLM,Model_Embed,Model_ASR,DB_Vector,DB_SQL,DB_File layer_data;
```

---

```mermaid
%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#EEF2FF',
    'primaryTextColor': '#1E293B',
    'primaryBorderColor': '#6366F1',
    'lineColor': '#94A3B8',
    'secondaryColor': '#F0FDFA',
    'tertiaryColor': '#FFF7ED',
    'fontFamily': 'Inter, system-ui, sans-serif',
    'fontSize': '14px'
  },
  'flowchart': {
    'htmlLabels': true,
    'curve': 'basis',
    'padding': 20,
    'nodeSpacing': 50,
    'rankSpacing': 80
  }
}%%

graph TB
    %% å®šä¹‰ç°ä»£ç»ç’ƒæ‹Ÿæ€é£æ ¼
    classDef uiLayer fill:linear-gradient(135deg,#667eea 0%,#764ba2 100%),stroke:#4F46E5,stroke-width:3px,color:#fff,rx:12,ry:12,box-shadow:0 8px 32px rgba(102,126,234,0.3);
    classDef gatewayLayer fill:linear-gradient(135deg,#f093fb 0%,#f5576c 100%),stroke:#DB2777,stroke-width:3px,color:#fff,rx:12,ry:12,box-shadow:0 8px 32px rgba(245,87,108,0.3);
    classDef brainLayer fill:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%),stroke:#0891B2,stroke-width:3px,color:#fff,rx:12,ry:12,box-shadow:0 8px 32px rgba(79,172,254,0.3);
    classDef bizLayer fill:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%),stroke:#059669,stroke-width:3px,color:#fff,rx:12,ry:12,box-shadow:0 8px 32px rgba(67,233,123,0.3);
    classDef infraLayer fill:linear-gradient(135deg,#fa709a 0%,#fee140 100%),stroke:#DC2626,stroke-width:3px,color:#fff,rx:12,ry:12,box-shadow:0 8px 32px rgba(250,112,154,0.3);
    
    classDef subGroup fill:rgba(255,255,255,0.9),stroke:#CBD5E1,stroke-width:2px,stroke-dasharray: 5 5,rx:8,ry:8;
    classDef connector fill:none,stroke:#64748B,stroke-width:2px,stroke-dasharray: 3 3;

    %% 1. ç”¨æˆ·äº¤äº’å±‚ - ç´«ç½—å…°æ¸å˜
    subgraph Layer_UI ["ğŸ¨ ç”¨æˆ·äº¤äº’å±‚ | Presentation Layer"]
        direction LR
        UI_Portal["ğŸŒ Web é—¨æˆ·<br/><span style='font-size:12px;opacity:0.9'>React 19 + Tailwind</span>"]
        UI_Chat["ğŸ’¬ æ™ºèƒ½å¯¹è¯<br/><span style='font-size:12px;opacity:0.9'>å®æ—¶äº¤äº’ç•Œé¢</span>"]
        UI_Visual["ğŸ“Š æ•°æ®å¯è§†åŒ–<br/><span style='font-size:12px;opacity:0.9'>Recharts å›¾è¡¨</span>"]
    end

    %% 2. æ¥å…¥ç½‘å…³å±‚ - ç«ç‘°æ¸å˜
    subgraph Layer_Gateway ["ğŸ›¡ï¸ æ¥å…¥ç½‘å…³å±‚ | API Gateway"]
        direction LR
        API_Rest["âš¡ RESTful API<br/><span style='font-size:12px;opacity:0.9'>FastAPI é«˜æ€§èƒ½</span>"]
        API_Socket["ğŸ”„ WebSocket<br/><span style='font-size:12px;opacity:0.9'>å®æ—¶æ¨æµ</span>"]
        API_Auth["ğŸ” å®‰å…¨è®¤è¯<br/><span style='font-size:12px;opacity:0.9'>JWT / OAuth2</span>"]
    end

    %% 3. æ™ºèƒ½ä¸­æ¢å±‚ - é’è‰²æ¸å˜
    subgraph Layer_Brain ["ğŸ§  æ™ºèƒ½ä¸­æ¢å±‚ | Agent Orchestrator"]
        direction LR
        Brain_Router["ğŸ¯ æ„å›¾è¯†åˆ«è·¯ç”±<br/><span style='font-size:12px;opacity:0.9'>Intent Router</span>"]
        Brain_Planner["ğŸ“‹ ä»»åŠ¡è§„åˆ’è°ƒåº¦<br/><span style='font-size:12px;opacity:0.9'>Task Planner</span>"]
        Brain_Memory["ğŸ’¾ ä¼šè¯è®°å¿†ç®¡ç†<br/><span style='font-size:12px;opacity:0.9'>Context Memory</span>"]
    end

    %% 4. ä¸šåŠ¡èƒ½åŠ›å±‚ - ç¿¡ç¿ æ¸å˜
    subgraph Layer_Biz ["âš™ï¸ ä¸šåŠ¡èƒ½åŠ›å±‚ | Business Capabilities"]
        direction TB
        
        subgraph Module_Skills ["ğŸ”§ åŸå­æŠ€èƒ½æ±  | Skill Registry"]
            direction LR
            Skill_Search["ğŸ” æ™ºèƒ½æœç´¢<br/>æ··åˆæ£€ç´¢"]
            Skill_Analysis["ğŸ§  æ·±åº¦åˆ†æ<br/>äººå²—åŒ¹é…"]
            Skill_Action["âš¡ ä¸šåŠ¡æ‰§è¡Œ<br/>å†…å®¹ç”Ÿæˆ"]
            Skill_KB["ğŸ“š çŸ¥è¯†é—®ç­”<br/>RAG æ£€ç´¢"]
        end

        subgraph Module_Agents ["ğŸ‘¥ å¤šæ™ºèƒ½ä½“åä½œ | Multi-Agent"]
            direction LR
            Agent_Interview["ğŸ¤ é¢è¯•ç³»ç»Ÿ<br/>Planner/Evaluator"]
            Agent_Resume["ğŸ“„ ç®€å†è§£æ<br/>OCR/Extraction"]
            Agent_Match["ğŸ§© åŒ¹é…å¼•æ“<br/>å‘é‡è¯­ä¹‰åŒ¹é…"]
        end
    end

    %% 5. åŸºç¡€è®¾æ–½å±‚ - æš–é˜³æ¸å˜
    subgraph Layer_Infra ["ğŸ—ï¸ æ¨¡å‹ä¸æ•°æ®åŸºåº§ | Infrastructure"]
        direction TB
        
        subgraph Models ["ğŸ¤– æ¨¡å‹æœåŠ¡ | Model Services"]
            direction LR
            Model_LLM["ğŸ§  DeepSeek-V3<br/>å¤§è¯­è¨€æ¨¡å‹"]
            Model_Embed["ğŸ”¢ BGE/Ark<br/>å‘é‡åµŒå…¥"]
            Model_ASR["ğŸ™ï¸ Faster-Whisper<br/>è¯­éŸ³è¯†åˆ«"]
        end

        subgraph Data ["ğŸ’¾ æ•°æ®å­˜å‚¨ | Data Storage"]
            direction LR
            DB_Vector["ğŸ—‚ï¸ ChromaDB<br/>å‘é‡æ•°æ®åº“"]
            DB_SQL["ğŸ—„ï¸ SQLite<br/>å…³ç³»å‹æ•°æ®åº“"]
            DB_File["ğŸ“ File System<br/>éç»“æ„åŒ–å­˜å‚¨"]
        end
    end

    %% è¿æ¥å…³ç³» - ä½¿ç”¨åŠ¨æ€è™šçº¿å’Œç®­å¤´
    UI_Portal -.->|HTTP/HTTPS| API_Rest
    UI_Chat -.->|REST| API_Rest
    UI_Chat -.->|WebSocket| API_Socket
    UI_Visual -.->|API| API_Rest

    API_Rest --> API_Auth
    API_Socket --> API_Auth
    API_Auth --> Brain_Router

    Brain_Router --> Brain_Planner
    Brain_Planner <--> Brain_Memory
    
    %% ç²—å®çº¿è¡¨ç¤ºæ ¸å¿ƒè°ƒåº¦
    Brain_Planner ==>|ğŸ› ï¸ å·¥å…·è°ƒç”¨| Module_Skills
    Brain_Planner ==>|ğŸ‘¥ ä»»åŠ¡å§”æ´¾| Module_Agents

    %% ä¸šåŠ¡å±‚åˆ°åŸºç¡€è®¾æ–½
    Module_Skills -.-> Models
    Module_Skills -.-> Data
    Module_Agents -.-> Models
    Module_Agents -.-> Data

    %% æ ·å¼åº”ç”¨
    class UI_Portal,UI_Chat,UI_Visual uiLayer;
    class API_Rest,API_Socket,API_Auth gatewayLayer;
    class Brain_Router,Brain_Planner,Brain_Memory brainLayer;
    class Skill_Search,Skill_Analysis,Skill_Action,Skill_KB,Agent_Interview,Agent_Resume,Agent_Match bizLayer;
    class Model_LLM,Model_Embed,Model_ASR,DB_Vector,DB_SQL,DB_File infraLayer;
    
    class Layer_UI,Layer_Gateway,Layer_Brain,Layer_Biz,Layer_Infra subGroup;
```

---

### **2. æ ¸å¿ƒæŠ€æœ¯æ ˆè¯´æ˜**

#### **å‰ç«¯ (Web Frontend)**
*   **æ¡†æ¶**: [App.tsx](file:///Users/baojuan/Desktop/AIE55%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%96%87%E4%BB%B6%E5%90%88%E8%AE%A1%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/55%E6%9C%9F%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%96%99/%E5%A4%A7%E6%A8%A1%E5%9E%8B/%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E6%8B%9B%E8%81%98/project/code/web/fontend/App.tsx) ä½¿ç”¨ **React 19** + **TypeScript**ã€‚
*   **çŠ¶æ€ç®¡ç†**: **Zustand** ç®¡ç†è½»é‡çº§å…¨å±€çŠ¶æ€ï¼Œ**TanStack Query** å¤„ç†å¼‚æ­¥è¯·æ±‚å’Œæ•°æ®ç¼“å­˜ã€‚
*   **UI/UX**: **Tailwind CSS** å“åº”å¼å¸ƒå±€ï¼Œ**Recharts** å±•ç¤ºæ‹›è˜æ¼æ–—å›¾è¡¨ï¼Œ**Lucide React** æä¾›å›¾æ ‡åº“ã€‚

#### **åç«¯ (Backend)**
*   **æ ¸å¿ƒæ¡†æ¶**: **FastAPI**ï¼Œæ”¯æŒå…¨å¼‚æ­¥ï¼ˆAsyncioï¼‰å¤„ç†ã€‚
*   **AI æ™ºèƒ½ä½“**: [AgentService](file:///Users/baojuan/Desktop/AIE55%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%96%87%E4%BB%B6%E5%90%88%E8%AE%A1%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/55%E6%9C%9F%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%96%99/%E5%A4%A7%E6%A8%A1%E5%9E%8B/%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E6%8B%9B%E8%81%98/project/code/backend/services/agent/service.py) åŸºäº **LangChain**ï¼Œæ ¸å¿ƒæ¨¡å‹ä¸º **DeepSeek**ã€‚
*   **æ•°æ®åº“**: **SQLAlchemy (ORM)** é©±åŠ¨çš„ **SQLite**ï¼ˆå…³ç³»å‹ï¼‰å’Œ **ChromaDB**ï¼ˆå‘é‡å‹ï¼‰ã€‚
*   **å¤šæ¨¡æ€**: é›†æˆ **Faster-Whisper** è¿›è¡Œé¢è¯•éŸ³é¢‘è½¬æ–‡å­—ã€‚

---

### **3. æ¨¡å—é—´äº¤äº’é€»è¾‘**

1.  **æ„å›¾é©±åŠ¨**: 
    *   ç”¨æˆ·åœ¨ [AIAssistant](file:///Users/baojuan/Desktop/AIE55%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%96%87%E4%BB%B6%E5%90%88%E8%AE%A1%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/55%E6%9C%9F%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%96%99/%E5%A4%A7%E6%A8%A1%E5%9E%8B/%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E6%8B%9B%E8%81%98/project/code/web/fontend/components/AIAssistant.tsx) æäº¤é—®é¢˜ï¼ˆå¦‚ï¼šâ€œå¸®æˆ‘æ‰¾ä¸‹ Java å·¥ç¨‹å¸ˆâ€ï¼‰ã€‚
    *   åç«¯ Agent è¯†åˆ«æ„å›¾ï¼Œè°ƒç”¨å¯¹åº”çš„ä¸šåŠ¡å·¥å…·ï¼ˆToolsï¼‰ã€‚
2.  **RAG æ£€ç´¢æµç¨‹**:
    *   çŸ¥è¯†åº“æŸ¥è¯¢è¯·æ±‚ -> `KnowledgeService` -> å¯¹é—®é¢˜è¿›è¡Œ Embedding -> `ChromaDB` å‘é‡æ£€ç´¢ -> æ£€ç´¢ç»“æœ + æç¤ºè¯ -> LLM æ€»ç»“ -> è¿”å›å‰ç«¯ã€‚
3.  **äººå²—åŒ¹é…æµç¨‹**:
    *   åŒ¹é…æŒ‡ä»¤ -> `JobMatcherService` -> æå– JD å‘é‡ -> åœ¨ `ChromaDB` ä¸­æŸ¥æ‰¾ç›¸ä¼¼ç®€å† -> ç»“åˆ SQLite ä¸­çš„åŸºç¡€ä¿¡æ¯ -> ç”Ÿæˆ `CandidateCard` ç»“æ„åŒ– JSON -> å‰ç«¯æ¸²æŸ“å¡ç‰‡ã€‚
4.  **é¢è¯•è¾…åŠ©æµç¨‹**:
    *   é¢è¯•å®˜å¼€å¯å½•éŸ³ -> [stt.py](file:///Users/baojuan/Desktop/AIE55%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%96%87%E4%BB%B6%E5%90%88%E8%AE%A1%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/55%E6%9C%9F%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%96%99/%E5%A4%A7%E6%A8%A1%E5%9E%8B/%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E6%8B%9B%E8%81%98/project/code/backend/api/v1/endpoints/stt.py) å®æ—¶è½¬ä¹‰ -> [InterviewAssistant](file:///Users/baojuan/Desktop/AIE55%E6%9C%9F%E8%AF%BE%E7%A8%8B%E6%96%87%E4%BB%B6%E5%90%88%E8%AE%A1%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/55%E6%9C%9F%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%96%99/%E5%A4%A7%E6%A8%A1%E5%9E%8B/%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E6%8B%9B%E8%81%98/project/code/web/fontend/components/InterviewAssistant.tsx) æ¸²æŸ“å¯¹è¯å®æ—¶æµ -> AI ç”Ÿæˆè¿½é—®å»ºè®®ã€‚

---

### **4. æ ¸å¿ƒæ¨¡å—è¯¦è§£**

#### **4.0 å…¨å±€æ™ºèƒ½åŠ©æ‰‹ (Global AI Assistant)**

è¯¥æ¨¡å—æ˜¯ç”¨æˆ·ä¸ç³»ç»Ÿäº¤äº’çš„ç»Ÿä¸€å…¥å£ï¼ˆChat Interfaceï¼‰ï¼Œä½äºé¦–é¡µ Tabã€‚å®ƒå……å½“ **ä¸­å¤®è°ƒåº¦å™¨ (Central Dispatcher)** çš„è§’è‰²ï¼Œç†è§£ç”¨æˆ·è‡ªç„¶è¯­è¨€æŒ‡ä»¤ï¼ŒåŠ¨æ€è°ƒç”¨åå°å„ä¸šåŠ¡å·¥å…·ï¼Œå¹¶ä»¥ç»“æ„åŒ–å¡ç‰‡ï¼ˆCard UIï¼‰çš„å½¢å¼è¿”å›ç»“æœã€‚

**æ ¸å¿ƒæµç¨‹å›¾ï¼š**

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ· (HR)
    participant FE as å‰ç«¯ (AIAssistant.tsx)
    participant Agent as åç«¯ Agent (LangChain)
    participant Tools as å·¥å…·é›† (Tools)
    participant LLM as å¤§æ¨¡å‹ (DeepSeek)

    User->>FE: è¾“å…¥æŒ‡ä»¤ (e.g., "å¸®æˆ‘æ‰¾ä¸ª Java ä¸“å®¶")
    FE->>Agent: POST /chat (Input + History)
    
    loop Reasoning Loop (ReAct)
        Agent->>LLM: æ€è€ƒ (Thought)
        LLM-->>Agent: å†³å®šè°ƒç”¨å·¥å…· (Action: search_candidates)
        
        Agent->>Tools: æ‰§è¡Œå·¥å…· (search_candidates(query="Java"))
        Tools-->>Agent: è¿”å›æ•°æ® (Candidates List)
        
        Agent->>LLM: è§‚å¯Ÿç»“æœ (Observation)
        LLM-->>Agent: ç”Ÿæˆæœ€ç»ˆå›å¤ (Final Answer)
    end
    
    Agent-->>FE: è¿”å› Markdown + JSON Card
    
    rect rgb(240, 248, 255)
        Note right of FE: åŠ¨æ€ UI æ¸²æŸ“
        FE->>FE: è§£æ JSON Card
        FE-->>User: å±•ç¤º "å€™é€‰äººå¡ç‰‡" (åŒ…å«åŒ¹é…åº¦/è¯¦æƒ…æŒ‰é’®)
    end
```

**å…³é”®æŠ€æœ¯ç‚¹ï¼š**

*   **ReAct èŒƒå¼**: é‡‡ç”¨ `Reasoning + Acting` æ¨¡å¼ï¼ŒAgent åœ¨å›ç­”å‰ä¼šå…ˆæ€è€ƒæ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·ï¼ˆå¦‚æœç´¢æ•°æ®åº“ã€æŸ¥è¯¢é¢è¯•è®°å½•ï¼‰ï¼Œç¡®ä¿å›å¤åŸºäºå®æ—¶æ•°æ®è€Œéæ¨¡å‹å¹»è§‰ã€‚
*   **ç»“æ„åŒ–åè®® (Card Protocol)**: åç«¯ Agent ä¸ä»…è¾“å‡ºæ–‡æœ¬ï¼Œè¿˜ä¼šè¾“å‡ºç‰¹å®šæ ¼å¼çš„ JSONï¼ˆå¦‚ `CandidateCard`, `JobCard`ï¼‰ã€‚å‰ç«¯é€šè¿‡ `cleanJsonContent` è§£æå™¨æå–è¿™äº› JSONï¼Œæ¸²æŸ“ä¸ºå¯äº¤äº’çš„ React ç»„ä»¶ï¼ˆå¦‚ç‚¹å‡»â€œå®‰æ’é¢è¯•â€æŒ‰é’®ï¼‰ã€‚
*   **å¼ºåˆ¶å·¥ä½œæµ (Enforced Workflow)**: System Prompt ä¸­æ¤å…¥äº†ä¸¥æ ¼çš„ä¸šåŠ¡è§„åˆ™ï¼ˆå¦‚â€œå…ˆæœç´¢å†ç»“è®ºâ€ã€â€œä¸¥ç¦ç›´æ¥å…¥åº“æ— æ„ä¹‰æ–‡æœ¬â€ï¼‰ï¼Œä¿éšœäº† Agent è¡Œä¸ºçš„å¯æ§æ€§å’Œå®‰å…¨æ€§ã€‚

#### **4.0.1 Skill æŠ€èƒ½è°ƒåº¦æ¶æ„ (Skill Dispatch)**

ä¸ºäº†ä½“ç°ç³»ç»Ÿå¯¹â€œæŠ€èƒ½ (Skill)â€æŠ€æœ¯çš„åº”ç”¨ï¼Œå³ Agent å¦‚ä½•é€šè¿‡å·¥å…·è°ƒç”¨ï¼ˆTool Callingï¼‰æ‰©å±•èƒ½åŠ›è¾¹ç•Œï¼Œç‰¹è¡¥å……ä»¥ä¸‹è§†å›¾ï¼š

```mermaid
graph LR
    %% æ ·å¼å®šä¹‰ - PPT é£æ ¼ (æ¨ªå‘å¸ƒå±€/é«˜å¯¹æ¯”åº¦)
    classDef core fill:#4A90E2,stroke:#357ABD,stroke-width:2px,color:white;
    classDef user fill:#FF6B6B,stroke:#D35400,stroke-width:2px,color:white;
    classDef skill_search fill:#FFF3CD,stroke:#FFC107,stroke-width:2px;
    classDef skill_analysis fill:#D4EDDA,stroke:#28A745,stroke-width:2px;
    classDef skill_action fill:#E2E6EA,stroke:#6C757D,stroke-width:2px;
    classDef skill_kb fill:#F8D7DA,stroke:#DC3545,stroke-width:2px;
    classDef output fill:#343A40,stroke:#343A40,stroke-width:2px,color:white;

    %% ä¸»æµç¨‹èŠ‚ç‚¹
    User(("ğŸ‘¤ ç”¨æˆ·æŒ‡ä»¤")) 
    Agent_Core{"ğŸ§  Agent Core\n(Router/Planner)"}
    Result["ğŸ“„ ç»“æ„åŒ–ç»“æœ\n(JSON/Card)"]
    Response["ğŸ’¬ æœ€ç»ˆå›å¤"]

    %% æŠ€èƒ½æ³¨å†Œè¡¨ (å‚ç›´å †å ä»¥é€‚åº”å®½å±)
    subgraph Skill_Registry ["ğŸ› ï¸ Skill Registry (æŠ€èƒ½æ³¨å†Œè¡¨)"]
        direction TB
        
        subgraph Group_Search ["ğŸ” æœç´¢ç±» (Search)"]
            direction TB
            S1["search_candidates"]
            S2["search_job_descriptions"]
            S3["get_candidates"]
            S4["get_job_descriptions"]
        end

        subgraph Group_Analysis ["ğŸ§  åˆ†æç±» (Analysis)"]
            direction TB
            A1["analyze_candidate_match"]
            A2["match_candidates_for_job"]
        end

        subgraph Group_Action ["âš¡ æ‰§è¡Œç±» (Action)"]
            direction TB
            C1["generate_interview_questions"]
            C2["create_job_description"]
            C3["create_candidate"]
        end

        subgraph Group_KB ["ğŸ“š çŸ¥è¯†ç±» (Knowledge)"]
            direction TB
            K1["query_hr_knowledge"]
            K2["search_interviews"]
        end
    end

    %% è¿çº¿é€»è¾‘ (Left to Right)
    User ==> Agent_Core
    
    Agent_Core -.->|"Intent: Search"| Group_Search
    Agent_Core -.->|"Intent: Analyze"| Group_Analysis
    Agent_Core -.->|"Intent: Action"| Group_Action
    Agent_Core -.->|"Intent: Query"| Group_KB

    Group_Search ==> Result
    Group_Analysis ==> Result
    Group_Action ==> Result
    Group_KB ==> Result

    Result ==> Agent_Core
    Agent_Core ==> Response

    %% æ ·å¼åº”ç”¨
    class User user;
    class Agent_Core core;
    class Group_Search,S1,S2,S3,S4 skill_search;
    class Group_Analysis,A1,A2 skill_analysis;
    class Group_Action,C1,C2,C3 skill_action;
    class Group_KB,K1,K2 skill_kb;
    class Result,Response output;
```

**Skill æŠ€æœ¯å®ç°æœºåˆ¶ï¼š**
1.  **æ³¨å†Œæœºåˆ¶**: æ‰€æœ‰ Skill (ç»§æ‰¿è‡ª `BaseTool`) åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶æ³¨å†Œåˆ° `Skill Registry`ï¼Œæ¯ä¸ª Skill åŒ…å« `name`, `description` å’Œ `args_schema` (Pydantic æ¨¡å‹)ã€‚
2.  **æ„å›¾è¯†åˆ«**: Agent æ ¹æ®ç”¨æˆ·è¾“å…¥çš„è¯­ä¹‰ï¼Œåˆ©ç”¨ LLM çš„ Function Calling èƒ½åŠ›ï¼Œè‡ªåŠ¨åŒ¹é…æœ€åˆé€‚çš„ Skillã€‚
3.  **å‚æ•°æå–**: Agent è‡ªåŠ¨ä»ä¸Šä¸‹æ–‡ä¸­æå– Skill æ‰€éœ€çš„ç»“æ„åŒ–å‚æ•°ï¼ˆå¦‚ï¼šä» "å¸®æˆ‘æ‰¾ Java" ä¸­æå– `query="Java"`ï¼‰ã€‚
4.  **æ‰§è¡Œä¸åé¦ˆ**: Skill æ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘ï¼ˆæ•°æ®åº“æŸ¥è¯¢/ç®—æ³•è°ƒç”¨ï¼‰ï¼Œå¹¶å°†ç»“æœä»¥ JSON æ ¼å¼è¿”å›ç»™ Agent è¿›è¡ŒäºŒæ¬¡å¤„ç†ã€‚

#### **4.1 æ™ºèƒ½ç®€å†è§£æ (Resume Parser)**

è¯¥æ¨¡å—è´Ÿè´£å°†éç»“æ„åŒ–çš„æ–‡ä»¶ï¼ˆPDF/Word/å›¾ç‰‡ï¼‰è½¬åŒ–ä¸ºæ ‡å‡†åŒ–çš„å€™é€‰äººæ•°æ®ã€‚

**æ ¸å¿ƒæµç¨‹å›¾ï¼š**

```mermaid
graph LR
    Input["ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ PDF/DOCX"] --> Extractor["æ–‡æœ¬æå–å™¨ (PyMuPDF/Python-docx)"]
    Extractor --> Text["çº¯æ–‡æœ¬ Raw Text"]
    Text --> LLM["LLM ç»“æ„åŒ–è§£æ (Instructor + Doubao/Ark)"]
    
    subgraph Analysis ["AI åˆ†æå±‚"]
        LLM -- "System Prompt" --> Role["è§’è‰²: æ‹›è˜ä¸“å®¶"]
        LLM -- "Extraction Rules" --> Rules["è§„åˆ™: å®ä½“æå–/æ—¶é—´æ ‡å‡†åŒ–/æŠ€èƒ½æŒ–æ˜"]
    end
    
    LLM --> JSON["ç»“æ„åŒ– JSON (ResumeParseResponse)"]
    
    subgraph PostProcess ["åå¤„ç†å±‚"]
        JSON --> Scoring["è¯„åˆ†å¼•æ“ (å®Œæ•´åº¦/ç»éªŒè®¡ç®—)"]
        JSON --> Mapping["å­—æ®µæ˜ å°„ (Frontend Schema)"]
    end
    
    Mapping --> DB[("SQLite æ•°æ®åº“")]
```

**å…³é”®æŠ€æœ¯ç‚¹ï¼š**
*   **Instructor**: ä½¿ç”¨ `instructor` åº“å¼ºåˆ¶ LLM è¾“å‡ºç¬¦åˆ Pydantic Model (`ResumeParseResponse`) çš„ä¸¥æ ¼ JSON æ ¼å¼ï¼Œè§£å†³äº†ä¼ ç»Ÿ LLM è¾“å‡ºæ ¼å¼ä¸ç¨³å®šçš„é—®é¢˜ã€‚
*   **æ™ºèƒ½è¯„åˆ†**: é™¤äº†åŸºç¡€ä¿¡æ¯æå–ï¼Œç³»ç»Ÿè¿˜ä¼šæ ¹æ®ç®€å†çš„å®Œæ•´åº¦ï¼ˆæ˜¯å¦æœ‰è”ç³»æ–¹å¼ã€æ•™è‚²èƒŒæ™¯ã€å·¥ä½œç»å†è¯¦ç»†ç¨‹åº¦ï¼‰è‡ªåŠ¨è®¡ç®— `parsing_score`ï¼Œè¾…åŠ© HR å¿«é€Ÿç­›é€‰ã€‚
*   **æŠ€èƒ½æŒ–æ˜**: Prompt ä¸­åŒ…å«æŒ‡ä»¤ï¼Œè¦æ±‚ AI ä¸ä»…æå–æ˜¾æ€§æŠ€èƒ½ï¼Œè¿˜è¦ä»é¡¹ç›®æè¿°ä¸­æ¨æ–­éšæ€§æŠ€æœ¯æ ˆã€‚

#### **4.2 äººå²—åŒ¹é…å¼•æ“ (Job Matcher)**

è¯¥æ¨¡å—å®ç°äº†åŸºäºå¤šç»´åº¦çš„å€™é€‰äººä¸èŒä½æè¿° (JD) çš„æ·±åº¦åŒ¹é…ã€‚

**æ ¸å¿ƒæµç¨‹å›¾ï¼š**

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ· (HR)
    participant Agent as AI Agent
    participant Matcher as JobMatcherService
    participant DB as æ•°æ®åº“ (TalentPool)
    participant LLM as å¤§æ¨¡å‹ (Doubao/Ark)

    User->>Agent: "å¸®æˆ‘æ‰¾åŒ¹é… Java å²—ä½çš„å€™é€‰äºº"
    Agent->>Matcher: è°ƒç”¨ analyze_match å·¥å…·
    
    rect rgb(240, 248, 255)
        Note over Matcher, DB: ç¬¬ä¸€æ­¥ï¼šåˆç­›
        Matcher->>DB: è·å–æ´»è·ƒå€™é€‰äºº (Filter: status != hired)
        DB-->>Matcher: è¿”å› Candidate åˆ—è¡¨
    end
    
    rect rgb(255, 240, 245)
        Note over Matcher, LLM: ç¬¬äºŒæ­¥ï¼šAI æ·±åº¦è¯„ä¼° (å¹¶å‘æ‰§è¡Œ)
        loop For Each Candidate
            Matcher->>LLM: å‘é€ JD + å€™é€‰äººç”»åƒ (Prompt)
            LLM-->>Matcher: è¿”å› MatchResult (åˆ†æ•°/åŒ¹é…ç‚¹/ä¸è¶³ç‚¹)
        end
    end
    
    Matcher->>Matcher: æŒ‰åˆ†æ•°é™åºæ’åº (Sort by Score)
    Matcher-->>Agent: è¿”å› Top N ç»“æœ
    Agent-->>User: æ¸²æŸ“ CandidateCard åˆ—è¡¨
```

**å…³é”®æŠ€æœ¯ç‚¹ï¼š**
*   **å¹¶å‘è¯„ä¼°**: ä½¿ç”¨ `asyncio.gather` å¹¶å‘è°ƒç”¨ LLM å¯¹å¤šä½å€™é€‰äººè¿›è¡Œè¯„ä¼°ï¼Œå¤§å¹…ç¼©çŸ­ç­‰å¾…æ—¶é—´ã€‚
*   **å¤šç»´è¯„ä¼°æ¨¡å‹**: Prompt è®¾è®¡äº†ä¸‰ä¸ªæ ¸å¿ƒç»´åº¦ï¼š
    1.  **æŠ€èƒ½åŒ¹é…**: ç¡¬æ€§æŠ€æœ¯æ ˆæ˜¯å¦å¯¹é½ã€‚
    2.  **ç»éªŒåŒ¹é…**: å¹´é™ã€è¡Œä¸šèƒŒæ™¯æ˜¯å¦ç¬¦åˆã€‚
    3.  **æ•™è‚²åŒ¹é…**: å­¦å†è¦æ±‚æ˜¯å¦è¾¾æ ‡ã€‚
*   **ç»“æ„åŒ–è¾“å‡º**: åŒ¹é…ç»“æœåŒ…å« `score` (0-100åˆ†)ã€`matching_points` (äº®ç‚¹) å’Œ `mismatched_points` (ä¸è¶³)ï¼Œç›´æ¥ç”¨äºå‰ç«¯å±•ç¤ºï¼Œæ— éœ€äºŒæ¬¡è§£æã€‚

#### **4.3 æ™ºèƒ½é¢è¯•åŠ©æ‰‹ (AI Interview Assistant) - Multi-Agent æ¶æ„**

```mermaid
sequenceDiagram
    participant HR as é¢è¯•å®˜ (HR)
    participant FE as å‰ç«¯ (React)
    participant API as åç«¯ (FastAPI)
    participant Agent_Plan as ç­–åˆ’ Agent (Planner)
    participant Agent_Q as å‡ºé¢˜ Agent (Questioner)
    participant Agent_Eval as è¯„ä¼° Agent (Evaluator)
    participant Agent_Decision as å†³ç­– Agent (Decision Maker)
    
    Note over HR, Agent_Decision: é¢è¯•å‡†å¤‡é˜¶æ®µ (Preparation)
    HR->>FE: é€‰æ‹©å€™é€‰äºº & JD
    FE->>API: POST /generate_interview_plan
    
    API->>Agent_Plan: åˆ†æç®€å† & JD (æå–å…³é”®è€ƒå¯Ÿç‚¹)
    Agent_Plan-->>API: è¿”å›è€ƒå¯Ÿç»´åº¦ (Criteria)
    
    API->>Agent_Q: ç”Ÿæˆé¢è¯•é¢˜ (åŸºäºç»´åº¦ & éš¾åº¦åˆ†å¸ƒ)
    Agent_Q-->>API: è¿”å›ç»“æ„åŒ–é¢è¯•é¢˜ (JSON)
    API-->>FE: å±•ç¤ºé¢è¯•å¤§çº²
    
    opt äººå·¥è°ƒæ•´ (Human-in-the-loop)
        HR->>FE: ä¿®æ”¹/æ›¿æ¢é¢˜ç›®
        FE->>API: POST /regenerate_question
        API->>Agent_Q: æ ¹æ® Feedback é‡æ–°ç”Ÿæˆ
        Agent_Q-->>API: è¿”å›æ–°é¢˜ç›®
    end
    
    Note over HR, Agent_Decision: é¢è¯•è¿›è¡Œé˜¶æ®µ (Execution)
    loop æ¯ä¸€é“é¢˜
        HR->>FE: è®°å½•é¢è¯•è¡¨ç° (ç¬”è®°/æ‰“åˆ†)
    end

    opt å®æ—¶è¿½é—® (Live)
        HR->>FE: å¼€å¯å½•éŸ³ (STT)
        FE->>API: WebSocket / Stream ä¼ è¾“éŸ³é¢‘æµ
        API->>Agent_Q: åˆ†æå½“å‰å›ç­”
        Agent_Q-->>FE: æ¨é€è¿½é—®å»ºè®® (Follow-up Questions)
    end
    
    rect rgb(255, 240, 245)
        Note over HR, Agent_Decision: é¢è¯•åè¯„ä¼° (Post-Interview Evaluation)
        HR->>FE: ç‚¹å‡» "ç”Ÿæˆé¢è¯•è¯„ä»·"
        FE->>API: POST /evaluate_interview
        
        par å¹¶è¡Œè¯„ä¼°ç»´åº¦ (Parallel Execution)
            API->>Agent_Eval: è¯„ä¼° "æŠ€æœ¯æ·±åº¦" Agent
            API->>Agent_Eval: è¯„ä¼° "é€»è¾‘æ€ç»´" Agent
            API->>Agent_Eval: è¯„ä¼° "æ²Ÿé€šèƒ½åŠ›" Agent
        end
        
        Agent_Eval-->>API: è¿”å›å„ç»´åº¦è¯„åˆ† & åé¦ˆ
        
        API->>Agent_Decision: ç»¼åˆæ±‡æ€» (Summary & Recommendation)
        Agent_Decision-->>API: ç”Ÿæˆå½•ç”¨å»ºè®® (Offer/Reject)
        API-->>FE: å±•ç¤ºè¯„ä¼°æŠ¥å‘Š (Radar Chart + Summary)
    end
```

**å…³é”®æŠ€æœ¯ç‚¹ (Multi-Agent Collaboration)ï¼š**

*   **åˆ†å·¥æ˜ç¡® (Role Specialization)**: ç³»ç»Ÿè¢«æ‹†åˆ†ä¸ºå¤šä¸ªä¸“èŒ Agentï¼Œå„å¸å…¶èŒï¼š
    *   **Planner Agent**: è´Ÿè´£é¡¶å±‚è§„åˆ’ï¼Œåˆ†æ JD å’Œç®€å†ï¼Œç¡®å®šè€ƒå¯Ÿç»´åº¦ã€‚
    *   **Questioner Agent**: è´Ÿè´£å…·ä½“æ‰§è¡Œï¼Œç”Ÿæˆç»“æ„åŒ–é¢è¯•é¢˜ï¼Œå¹¶æ”¯æŒå®æ—¶è¿½é—®ã€‚
    *   **Evaluator Agent**: è´Ÿè´£å‚ç›´é¢†åŸŸçš„æ·±åº¦è¯„ä¼°ï¼Œå¹¶è¡Œå·¥ä½œä»¥æé«˜æ•ˆç‡ã€‚
    *   **Decision Maker Agent**: è´Ÿè´£å…¨å±€æ±‡æ€»ï¼Œç»¼åˆå„æ–¹æ„è§ç»™å‡ºæœ€ç»ˆå†³ç­–ã€‚
*   **å¹¶è¡Œè®¡ç®— (Parallel Execution)**: åœ¨è¯„ä¼°é˜¶æ®µï¼Œåˆ©ç”¨ `asyncio.gather` åŒæ—¶è°ƒç”¨å¤šä¸ª Evaluator Agentï¼Œæ˜¾è‘—é™ä½äº†é•¿æ–‡æœ¬åˆ†æçš„ç­‰å¾…æ—¶é—´ï¼ˆLatencyï¼‰ã€‚
*   **äººæœºååŒ (Human-in-the-loop)**: åœ¨ç”Ÿæˆé¢è¯•é¢˜é˜¶æ®µï¼ŒAgent å¹¶éâ€œä¸€è¨€å ‚â€ï¼Œè€Œæ˜¯å…è®¸ HR ä»‹å…¥ä¿®æ”¹ï¼ˆFeedbackï¼‰ï¼ŒAgent ä¼šæ ¹æ®åé¦ˆåŠ¨æ€è°ƒæ•´åç»­è¾“å‡ºã€‚
*   **ç»“æ„åŒ–è¾“å‡º (Structured Output)**: æ‰€æœ‰ Agent å‡é€šè¿‡ `instructor` åº“å¼ºåˆ¶è¾“å‡º JSON æ ¼å¼ï¼Œç¡®ä¿äº†ç³»ç»Ÿé—´æ•°æ®æµè½¬çš„ç¨³å®šæ€§ã€‚

#### **4.3.1 Agent ååŒè§†å›¾ (Collaboration Graph)**

ä¸ºäº†æ›´ç›´è§‚åœ°å±•ç¤ºå„ Agent ä¹‹é—´çš„åä½œå…³ç³»ä¸æ•°æ®æµè½¬ï¼Œç‰¹è¡¥å……ä»¥ä¸‹ååŒè§†å›¾ï¼š

```mermaid
graph TD
    %% Define Styles
    classDef planner fill:#e1f5fe,stroke:#01579b,stroke-width:2px;
    classDef questioner fill:#fff9c4,stroke:#fbc02d,stroke-width:2px;
    classDef evaluator fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px;
    classDef decision fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px;
    classDef artifact fill:#ffffff,stroke:#333,stroke-dasharray: 5 5;

    %% Input Data
    JD[æ‹›è˜éœ€æ±‚ JD]
    Resume[å€™é€‰äººç®€å†]

    %% Agent 1: Planner
    subgraph Planner_Agent [Planner Agent: ç­–åˆ’ä¸åˆ†æ]
        direction TB
        Analyze[æ·±åº¦åˆ†æ]
        Criteria[ç”Ÿæˆè€ƒå¯Ÿç»´åº¦]
    end
    
    %% Agent 2: Questioner
    subgraph Questioner_Agent [Questioner Agent: å‡ºé¢˜ä¸äº¤äº’]
        direction TB
        GenQ[ç”Ÿæˆç»“æ„åŒ–é¢è¯•é¢˜]
        RefineQ[æ ¹æ®åé¦ˆä¼˜åŒ–é¢˜ç›®]
        LiveQ[å®æ—¶è¿½é—®ç”Ÿæˆ]
    end

    %% Agent 3: Evaluators (Parallel)
    subgraph Evaluator_Swarm [Evaluator Agents: å¹¶è¡Œè¯„ä¼°]
        direction TB
        Eval_Tech[æŠ€æœ¯æ·±åº¦è¯„ä¼° Agent]
        Eval_Logic[é€»è¾‘æ€ç»´è¯„ä¼° Agent]
        Eval_Comm[æ²Ÿé€šèƒ½åŠ›è¯„ä¼° Agent]
    end

    %% Agent 4: Decision Maker
    subgraph Decision_Agent [Decision Maker: ç»¼åˆå†³ç­–]
        Synthesize[å¤šç»´åº¦æ±‡æ€»]
        Result[å½•ç”¨å»ºè®® & æŠ¥å‘Š]
    end

    %% Data Flow & Collaboration
    JD & Resume --> Analyze
    Analyze --> Criteria
    Criteria --> GenQ
    
    GenQ --> |Human Feedback| RefineQ
    RefineQ --> GenQ
    
    GenQ --> |Interview Session| QA_Log[é—®ç­”è®°å½•/å½•éŸ³]
    LiveQ -.-> |Context| QA_Log
    
    QA_Log --> Eval_Tech
    QA_Log --> Eval_Logic
    QA_Log --> Eval_Comm
    JD --> Evaluator_Swarm
    
    Eval_Tech & Eval_Logic & Eval_Comm --> Synthesize
    Synthesize --> Result

    %% Styling
    class Planner_Agent,Analyze,Criteria planner;
    class Questioner_Agent,GenQ,RefineQ,LiveQ questioner;
    class Evaluator_Swarm,Eval_Tech,Eval_Logic,Eval_Comm evaluator;
    class Decision_Agent,Synthesize,Result decision;
    class JD,Resume,QA_Log artifact;
```

#### **4.4 HR çŸ¥è¯†åº“ (Knowledge Base)**

è¯¥æ¨¡å—åœ¨å‰ç«¯ï¼ˆ`KnowledgeBase.tsx`ï¼‰åˆ†ä¸º **â€œæ£€ç´¢æ¨¡å¼â€** å’Œ **â€œAI é—®ç­”æ¨¡å¼â€** ä¸¤ä¸ªæ ¸å¿ƒ Tabï¼Œåˆ†åˆ«å¯¹åº” **çŸ¥è¯†ç®¡ç† (CRUD)** å’Œ **æ™ºèƒ½é—®ç­” (RAG)** ä¸¤å¤§ä¸šåŠ¡æµã€‚

**1. æ£€ç´¢æ¨¡å¼ (Search Mode)**
æä¾›å¯¹å†…éƒ¨çŸ¥è¯†ï¼ˆé¢è¯•æ ‡å‡†ã€è€ƒå¯Ÿé‡ç‚¹ã€å…¬å¸åˆ¶åº¦ï¼‰çš„å¢åˆ æ”¹æŸ¥åŠæ ‡ç­¾ç­›é€‰ã€‚

**2. AI é—®ç­”æ¨¡å¼ (Chat Mode / RAG)**
åŸºäº RAG æŠ€æœ¯ï¼Œå…è®¸ HR ç”¨è‡ªç„¶è¯­è¨€æé—®ï¼Œç³»ç»Ÿé€šè¿‡æ··åˆæ£€ç´¢ç”Ÿæˆå¸¦å¼•ç”¨çš„å›ç­”ã€‚

**æ ¸å¿ƒæµç¨‹å›¾ï¼š**

```mermaid
graph TD
    subgraph Frontend [å‰ç«¯: KnowledgeBase.tsx]
        Tab_Search[Tab: æ£€ç´¢æ¨¡å¼]
        Tab_Chat[Tab: AI é—®ç­”æ¨¡å¼]
        
        Tab_Search -- "CRUD æ“ä½œ" --> API_CRUD[API: /knowledge]
        Tab_Chat -- "ç”¨æˆ·æé—®" --> API_Chat[API: /knowledge/chat]
    end

    subgraph Backend_Service [åç«¯: KnowledgeService]
        API_CRUD -- "è¯»å†™" --> DB[(SQLite: Knowledge Table)]
        
        API_Chat -- "1. æ„å›¾è¯†åˆ«" --> Intent{æ„å›¾è·¯ç”±å™¨}
        Intent -- "é—²èŠ" --> LLM_Direct[LLM ç›´æ¥å›ç­”]
        Intent -- "çŸ¥è¯†æŸ¥è¯¢" --> RAG_Flow[RAG æ£€ç´¢æµç¨‹]
    end
    
    subgraph RAG_Flow [RAG æ ¸å¿ƒé“¾è·¯]
        Q[åŸå§‹é—®é¢˜] --> Rewrite["æŸ¥è¯¢é‡å†™ (Query Rewriter)"]
        Rewrite --> Emb["ç”Ÿæˆå‘é‡ (ArkEmbeddings)"]
        
        Emb --> Search_Vector["å‘é‡æ£€ç´¢ (ChromaDB)"]
        Rewrite --> Search_Keyword["å…³é”®è¯æ£€ç´¢ (BM25)"]
        
        Search_Vector --> Rerank["æ··åˆæ’åº (Hybrid Rerank)"]
        Search_Keyword --> Rerank
        Rerank --> Context["Top-K æ–‡æ¡£ç‰‡æ®µ"]
        
        Context --> LLM_Generate["LLM ç”Ÿæˆå›ç­”"]
        Q --> LLM_Generate
    end
    
    LLM_Generate -- "è¿”å›ç­”æ¡ˆ + å¼•ç”¨ID" --> Tab_Chat
```

**å…³é”®æŠ€æœ¯ç‚¹ï¼š**
*   **åŒæ¨¡å¼è®¾è®¡**: å‰ç«¯é€šè¿‡ `activeTab` çŠ¶æ€åˆ‡æ¢è§†å›¾ï¼Œæ»¡è¶³â€œæŸ¥é˜…æ–‡æ¡£â€å’Œâ€œè§£å†³é—®é¢˜â€ä¸¤ç§ä¸åŒåœºæ™¯ã€‚
*   **æ··åˆæ£€ç´¢ (Hybrid Search)**: ç»“åˆå‘é‡æ£€ç´¢ (ChromaDB) å’Œ å…³é”®è¯æ£€ç´¢ (BM25)ï¼Œæœ‰æ•ˆè§£å†³ä¸“ä¸šæœ¯è¯­åŒ¹é…ä¸å‡†çš„é—®é¢˜ã€‚
*   **å†·å¯åŠ¨ç­–ç•¥**: `seed_data_if_empty` æ–¹æ³•ä¿è¯äº†ç³»ç»Ÿåˆå§‹åŒ–æ—¶ä¼šè‡ªåŠ¨å†™å…¥é»˜è®¤çš„ HR çŸ¥è¯†æ¡ç›®ï¼Œå¼€ç®±å³ç”¨ã€‚

#### **4.5 äººæ‰åº“ç®¡ç† (Talent Pool)**

è¯¥æ¨¡å—è´Ÿè´£å€™é€‰äººå…¨ç”Ÿå‘½å‘¨æœŸçš„çŠ¶æ€ç®¡ç†å’Œæ•°æ®æŒä¹…åŒ–ã€‚

**æ ¸å¿ƒæµç¨‹å›¾ï¼š**

```mermaid
graph LR
    Resume[ç®€å†è§£ææ•°æ®] --> |Create| Candidate[å€™é€‰äººè®°å½•]
    
    subgraph Status_Management [çŠ¶æ€æµè½¬]
        New[æ–°å€™é€‰äºº] --> |Screening| Interview[é¢è¯•ä¸­]
        Interview --> |Offer| Hired[å·²å…¥èŒ]
        Interview --> |Reject| Archived[å½’æ¡£]
    end
    
    Candidate --> Status_Management
    
    Hired --> |Trigger| JD_Update[æ›´æ–° JD æ‹›è˜è¿›åº¦]
    
    Status_Management --> |Filter/Search| API_List[åˆ—è¡¨æŸ¥è¯¢ API]
    API_List --> UI[äººæ‰åº“å¤§ç›˜]
```

**å…³é”®æŠ€æœ¯ç‚¹ï¼š**
*   **çŠ¶æ€è”åŠ¨**: å½“å€™é€‰äººçŠ¶æ€å˜æ›´ä¸º `hired` æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è§¦å‘å…³è” JD çš„ `current_hired_count` +1ï¼Œä¿è¯äº†æ‹›è˜è¿›åº¦çš„å®æ—¶ä¸€è‡´æ€§ã€‚
*   **å¤šç»´ç­›é€‰**: `CRUD` å±‚å®ç°äº†åŸºäº `position`ã€`status`ã€`search` (æ¨¡ç³ŠåŒ¹é…å§“å/é‚®ç®±) çš„åŠ¨æ€ SQL ç»„åˆæŸ¥è¯¢ã€‚
*   **å»é‡æœºåˆ¶**: åœ¨åˆ›å»ºå€™é€‰äººæ—¶ï¼Œè‡ªåŠ¨æ£€æŸ¥ `name` + `contact` æ˜¯å¦å·²å­˜åœ¨ï¼Œé˜²æ­¢é‡å¤å½•å…¥ã€‚

#### **4.6 æ‹›è˜åŸ¹è®­ (Recruit Training) - (è§„åˆ’ä¸­)**

ç›®å‰å¤„äº `TODO` çŠ¶æ€ï¼Œè§„åˆ’åˆ©ç”¨ AI åˆ†æå€™é€‰äººæŠ€èƒ½ç¼ºå£ï¼Œè‡ªåŠ¨æ¨èå…¥èŒåŸ¹è®­è¯¾ç¨‹ï¼ˆå¦‚ï¼šæŠ€æœ¯æ ˆå…¥é—¨ã€ä¼ä¸šæ–‡åŒ–ç­‰ï¼‰ã€‚
